<!DOCTYPE html>
<html lang="en">
<head>
        <title>Raising Heldscalla - Python 3</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://blog.heldscal.la/theme/css/main.css" type="text/css" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://blog.heldscal.la/css/ie.css"/>
                <script src="http://blog.heldscal.la/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://blog.heldscal.la/css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://blog.heldscal.la">Raising Heldscalla </a></h1>
                <nav>
                    <a href="http://blog.heldscal.la/pages/about-the-author.html">About the Author</a>&nbsp;
                    <a href="http://blog.heldscal.la/pages/impressum.html">Impressum</a>&nbsp;
                    <a href="http://blog.heldscal.la/category/blog.html">Blog</a>&nbsp;
                    <a href="http://blog.heldscal.la/category/psa.html">PSA</a>&nbsp;
                    <a href="http://blog.heldscal.la/category/retro.html">Retro</a>&nbsp;
                </nav>
        </header><!-- /#banner -->
        
        

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://blog.heldscal.la/anki-rikaisama-arch.html">Real-time Anki import from your browser with Rikaisama on Arch Linux</a></h1> 
<footer class="post-info">
        <abbr class="published" title="2015-01-21T00:00:00+01:00">
                Wed 21 January 2015
        </abbr>
<p>tags: <a href="http://blog.heldscal.la/tag/arch-linux.html">Arch Linux</a><a href="http://blog.heldscal.la/tag/python-3.html">Python 3</a><a href="http://blog.heldscal.la/tag/japanese.html">Japanese</a><a href="http://blog.heldscal.la/tag/firefox.html">Firefox</a></p></footer><!-- /.post-info --><p>One of the best tools for learning Japanese (or any language, really) is the spaced repetition program <a href="https://en.wikipedia.org/wiki/Anki_%28software%29">Anki</a>. It is available for a lot of platforms, it's free and open source (GPL3) and can synchronize your learning progress across devices.</p>
<p>Another great tool is the Firefox add-on <a href="http://rikaisama.sourceforge.net/">Rikaisama</a>. Based on the more popular <a href="https://addons.mozilla.org/en-US/firefox/addon/rikaichan/">Rikaichan</a>, it's a dictionary for looking up Japanese words directly in your browser. Rikaisama adds a lot more advanced functionality, like using EPWING dictionaries, querying Japanese web dictionaries and the feature I'm going to talk about here, adding words to your Anki deck automatically, complete with reading and translation.</p>
<p>If you do a lot of reading on the web, this can nearly completely eliminate the tedious process of creating an Anki deck. I find that, in my experience, it also encourages you to add more words to your deck than you would have without it, because it's just a button press and not several copy-and-pastes.</p>
<p>On the technical side, this works by installing an <a href="https://ankiweb.net/shared/info/2512410601">Anki plugin</a> that makes Anki listen on a local UDP port for new cards. Rikaisama in turn starts a Python script that writes the cards to this UDP port when called.</p>
<p>And here's where the problem begins for Arch Linux users.  Most distribution ship with Python 2 as a standard, but Arch Linux uses the slightly incompatible Python 3. You can install <a href="https://wiki.archlinux.org/index.php/Python">Python 2</a> on Arch Linux, but the script inside of Rikaisama will still refer to just 'python', which is Python 3 on Arch.
It's easy to modify Rikaisama to use the right version, though. Rikaisama is provided as an .xpi file, which is a packed Firefox add-on. You can unpack the file (which is in fact a zip file) with 7zip:</p>
<div class="highlight"><pre><span class="nv">$ </span>7z x Rikaisama_v20.3.xpi
</pre></div>


<p>You quick grep will tell you which file to change:</p>
<div class="highlight"><pre><span class="nv">$ </span>grep -r python
udp/RealTimeImport_UDP_Client.py:#!/usr/bin/env python2
udp/run_udp.sh:python <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="nv">$2</span> <span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
</pre></div>


<p>As you see, udp/run_udp.sh doesn't use the correct python version. Change the line to read</p>
<div class="highlight"><pre>python2 <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="nv">$2</span> <span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
</pre></div>


<p>and you're done. Now you can re-pack the file for use in Firefox. In the folder with the source files, pack the files with 7zip:</p>
<div class="highlight"><pre><span class="nv">$ </span>7z a ../Rikaisama.fixed.xpi * -r
</pre></div>


<p>You can now use Rikaisama.fixed.xpi to install the add-on, it will use the correct python version and you can finally import directly into Anki.</p>
<p>You can find a <a href="https://github.com/rogerbraun/rikaisama/raw/master/Rikaisama_v20.3_arch.xpi">version of Rikaisama</a> containing this change on <a href="http://github.com/rogerbraun/rikaisama">GitHub</a>.</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://blog.heldscal.la/" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/rogerbraun">Twitter</a></li>
                            <li><a href="http://github.com/rogerbraun">GitHub</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                     Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>. Theme is using <a href="http://github.com/getpelican/pelican-themes" target="_blank">cebong</a>.
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->

</body>
</html>